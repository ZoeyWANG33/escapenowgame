<html>
  <head>
    <meta charset="utf-8">
    <!-- PyScript CSS -->
    <link rel="stylesheet" href="https://pyscript.net/releases/2024.1.1/core.css">
    <!-- This script tag bootstraps PyScript -->
    <script type="module" src="https://pyscript.net/releases/2024.1.1/core.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.5.0/p5.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.5.0/addons/p5.sound.min.js"></script>
    <link rel="stylesheet" href="style.css">
    <script>function setup() {}</script>
    <!-- error script -->
    <script>
      window.onerror = function(msg, url, linenumber) {
        alert('Error message: '+msg+'\nURL: '+url+'\nLine Number: '+linenumber);
        return true;
      }
    </script>
  </head>
  <body>
    <p>ESCAPE NOW!</p>
    <p>Press Arrow Key to move</p>
    <p>Press WASD to shot the bullet </p>
    <p>Find the Secret Key to escape!</p>
  
    <py-config type="toml">
        [[fetch]]
        files = ["./main.py",
                 "./Player.py",
                 "./Mushroom.py",
                 "./Toxic.py",
                 "./MagicBottle.py",
                 "./Bullet.py",
                 "./Stone.py",
                 "./Key.py",
                 "./Door.py"]
    </py-config>
  
    <py-script id="output">
      from pyodide.ffi import create_proxy
      from main import *
      
      def run(*args):
        draw()
        p5.requestAnimationFrame(create_proxy(run))
      
      setup()
      run()

      p5.keyPressed = create_proxy(keyPressed)
      p5.keyReleased = create_proxy(keyReleased) 
      p5.mousePressed = create_proxy(mousePressed) 
      p5.mouseReleased = create_proxy(mouseReleased)
    </py-script>
  </body>
</html>
